import pandas as pd

# Read the input values
input_values = """
   Time 
0
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294

Oxygen
12.862
9.0738
4.9715
3.9543
3.6023
3.5966
3.6007
3.6029
3.601
3.5988
3.6415
3.7086
3.7831
3.8232
3.8532
3.8949
3.9577
4.0392
4.1333
4.2374
4.3503
4.4688
4.5906
4.7103
4.834
4.9563
5.0797
4.9488
4.412
3.8322
3.4649
3.4636
3.4649
3.465
3.467
3.5222
3.6
3.6787
3.7089
3.7319
3.7685
3.8304
3.9085
4.0088
4.1173
4.2359
4.3602
4.4877
4.6202
4.7514
4.8818
5.0107
5.1386
5.2631
5.3815
5.4965
5.6099
5.7223
5.3992
4.6992
3.9381
3.573
3.5469
3.5443
3.5454
3.5432
3.5422
3.5376
3.5758
3.6486
3.7245
3.7709
3.7966
3.8402
3.9043
3.9865
4.0844
4.1937
4.3114
4.4355
4.5625
4.6899
4.8159
4.9402
5.0637
5.1855
5.3042
5.4221
5.5344
5.6051
4.9299
4.1782
3.4279
3.3821
3.3796
3.3624
3.3631
3.4197
3.5057
3.5715
3.5854
3.5939
3.6233
3.668
3.7317
3.8084
3.8992
3.9979
4.1035
4.2132
4.3278
4.4441
4.5588
4.6713
4.7835
4.8972
5.0082
5.1168
5.2211
5.3249
6.3059
7.2406
8.1361
8.1143
8.1004
8.0866
8.0744
7.743
7.3152
6.0715
4.8302
3.6881
3.3629
3.3576
3.3572
3.3505
3.35
3.3485
3.4223
3.4989
3.5749
3.5906
3.6118
3.6527
3.7132
3.789
3.8807
3.9835
4.0957
4.2121
4.3311
5.6948
7.0182
8.2982
8.2954
8.2874
8.2688
8.2348
8.1983
8.1677
8.1441
8.1221
7.4852
6.1855
4.5759
3.5835
3.2618
3.2575
3.2611
3.258
3.2568
3.2536
3.3235
3.3947
3.4689
3.4868
3.5178
3.5663
3.6334
3.7152
3.8126
3.9187
5.3933
6.8223
8.2005
8.1691
8.1358
"""

# Split the input values into a list of strings
values_list = input_values.strip().split()

# Initialize a variable to store the current header
current_header = None

# Sample data
data = {
    'Time': [],
    'Oxygen': []
}

# Loop through the values
for value in values_list:
    # Check if the value is a header
    if value.strip().isalpha():
        current_header = value.strip()
    else:
        # If not a header, append the value to the corresponding list in the data dictionary
        data[current_header].append(float(value.strip()))

# Convert data to DataFrame
df = pd.DataFrame(data)

# Calculate time differences
df['Time_diff'] = df['Time'].diff()

# Define threshold for time continuity
time_threshold = 5
# Identify group breaks
df['Group'] = (df['Time_diff'] > time_threshold).cumsum()

# Group data by 'Group'
grouped_data = df.groupby('Group')

# Calculate the average oxygen value for each group
group_averages = grouped_data['Oxygen'].mean()

# Save group averages to a CSV file
group_averages.to_csv('o2_group_averages.csv', header=['Average Oxygen'], index_label='Group')
print("Group average oxygen values saved to o2_group_averages.csv")
